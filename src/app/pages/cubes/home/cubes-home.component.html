<div class="sg-flex-row" style="height: 100%;">

  <div style="width: 25%;height: 100%;">
    <div [style.height.px]="resultsSummaryHeight">

      <div ngbDropdown class="d-inline-block" style="width: 100%">
        <button class="btn btn-outline-primary" id="cubeTypeDropdown" style="width: 100%" ngbDropdownToggle>
          {{ cubeTypes.get(selectedCube) }}
        </button>
        <div ngbDropdownMenu aria-labelledby="cubeTypeDropdown" style="width: 100%">
          <button *ngFor=" let type of cubeTypes | keyvalue" (click)="selectedCube = type.key"
                  ngbDropdownItem>{{type.value}}</button>
        </div>
      </div>

      <div>
        Najszybsze ułożenie {{min | date: 'mm:ss.S'}}
      </div>
      <div>
        Najwolniejsze ułożenie {{max | date: 'mm:ss.S'}}
      </div>
      <div>
        Średnia {{avg | date: 'mm:ss.S'}}
      </div>
      <div>
        Średnia z ostatnich {{movingAverageNumberOfElements}} elementów {{avgOfLastNElements | date: 'mm:ss.S'}}
      </div>
    </div>

    <div class="table-responsive" [style.height.px]="resultsTableHeight">
      <table style="width: 100%;" class="table table-sm table-striped results-table">
        <thead>
        <tr>
          <th style="width: 175px;">Data wyniku</th>
          <th style="text-align: right; width: 50px;">Wynik</th>
          <th style="text-align: right; width: 50px;" *ngIf="movingAverageNumberOfElements < 5">
            Ao{{movingAverageNumberOfElements}}
          </th>
          <th style="text-align: right; width: 50px;">
            Ao5
          </th>
          <th style="text-align: right; width: 50px;" *ngIf="movingAverageNumberOfElements > 5">
            Ao{{movingAverageNumberOfElements}}
          </th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let record of statsForSelectedCube">
          <td style="width: 175px;">{{ record.recordTime | localizedDate : 'yyyy-MM-dd HH:mm:ss' }}</td>
          <td style="text-align: right; width: 50px;">{{ record.time | date : 'mm:ss.S' }}</td>
          <td style="text-align: right; width: 50px;" *ngIf="movingAverageNumberOfElements < 5">
            {{record.averages.get(movingAverageNumberOfElements) | date : 'mm:ss.S' }}
          </td>
          <td style="text-align: right; width: 50px;">
            {{record.averages.get(5) | date : 'mm:ss.S'}}
          </td>
          <td style="text-align: right; width: 50px;" *ngIf="movingAverageNumberOfElements > 5">
            {{record.averages.get(movingAverageNumberOfElements) | date : 'mm:ss.S'}}
          </td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div style="width: 50%;" class="sg-flex-column sg-flex-justify-space-around">

    <div class="sg-flex-column">
      <sg-timer [width]="clockWidth" #timer></sg-timer>
      <div class="sg-flex-row">
        <button *ngIf="!timer.isRunning()" (click)="start()"
                class="btn btn-outline-primary sg-flex-fill-available-space-evenly">
          Start
        </button>
        <button *ngIf="!timer.isRunning() && timer.committedTime" (click)="resume()"
                class="btn btn-outline-primary sg-flex-fill-available-space-evenly">
          Wznów
        </button>
        <button *ngIf="timer.isRunning()" (click)="stop()"
                class="btn btn-outline-primary sg-flex-fill-available-space-evenly">
          Stop
        </button>
        <button *ngIf="!timer.isRunning() && timer.committedTime" (click)="save()"
                class="btn btn-outline-primary sg-flex-fill-available-space-evenly">
          Zapisz
        </button>
        <button *ngIf="!timer.isRunning() && timer.committedTime" (click)="saveWithoutScramble()"
                class="btn btn-outline-primary sg-flex-fill-available-space-evenly">
          Zapisz bez scrambla
        </button>
      </div>
    </div>

    <div class="sg-flex-column">
      <div>
        <canvas baseChart #cubesRecordsChart='base-chart' style="position: relative"
                [datasets]="cubeRecordsLineChart.lineChartData"
                [labels]="cubeRecordsLineChart.lineChartLabels"
                [options]="cubeRecordsLineChart.lineChartOptions"
                [colors]="cubeRecordsLineChart.lineChartColors"
                [legend]="cubeRecordsLineChart.lineChartLegend"
                [chartType]="cubeRecordsLineChart.lineChartType"
                [plugins]="cubeRecordsLineChart.lineChartPlugins">

        </canvas>
      </div>
      <div class="sg-flex-row">
        <button (click)="cubeRecordsChartType = 'RAW'"
                class="btn btn-outline-primary sg-flex-fill-available-space-evenly">
          Zwykły
        </button>
        <div ngbDropdown class="sg-flex-row sg-flex-fill-available-space-evenly">
          <button class="btn btn-outline-primary sg-flex-fill-available-space-evenly" id="movingAverageSettings"
                  ngbDropdownToggle>Średnia ruchoma
          </button>
          <div ngbDropdownMenu aria-labelledby="movingAverageSettings">
            <div class="form-group">
              <label for="movingAverageElementsCount">Liczba elementów do średniej</label>
              <input [(ngModel)]="movingAverageNumberOfElements" type="number" class="form-control"
                     id="movingAverageElementsCount">
            </div>
            <button (click)="cubeRecordsChartType = 'MOVING_AVERAGE'"
                    class="btn btn-outline-primary sg-flex-fill-available-space-evenly">
              Ustaw
            </button>
          </div>
        </div>


      </div>

    </div>

  </div>

  <div style="width: 25%;" class="sg-flex-column">

    <div [hidden]="!visible">
      <canvas #rubiks></canvas>
    </div>

    <div *ngIf="isThreeByThree() && turns">{{turns}}</div>

    <div class="sg-flex-row">
      <button *ngIf="isThreeByThree()" (click)="scramble()"
              class="btn btn-outline-primary sg-flex-fill-available-space-evenly">
        Scramble
      </button>
      <button *ngIf="isThreeByThree() && turns" (click)="resetScramble()"
              class="btn btn-outline-primary sg-flex-fill-available-space-evenly">
        Reset
      </button>
    </div>
  </div>
</div>
